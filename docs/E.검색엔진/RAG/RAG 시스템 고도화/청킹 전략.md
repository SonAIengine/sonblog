문서 전처리 단계는 RAG 시스템에서 실제 검색에 사용될 문서들을 가공하여, 검색과 생성에 최적화된 형태로 변환하는 과정이다. 효과적인 전처리는 검색 정확도를 높이고, 관련성 있는 정보를 더 잘 추출할 수 있게 도우며, 궁극적으로 생성 모델의 응답 품질을 향상시킨다.

문서 전처리 과정은 여러 단계로 구성되는데, 그 중 핵심적인 단계가 청킹(chunking), 즉 문서 분할 단계이다. 문서 분할은 긴 문서를 더 작고 관리하기 쉬운 단위로 나누는 과정이다.

효과적인 분할 방식은 관련 정보 정보의 검색 정확도를 높이고, 문맥의 일관성을 유지하는 데 도움을 준다. 또한 생성 모델이 처리해야 할 컨텍스트 양을 적절히 조절하여 응답 생성의 품질을 향상 시킬 수 있다.

가장 기본적인 문서 분할 방식은 **문자 수 기반 분할**(character splitting)이다.
이는 문서를 단순히 일정 길이의 문자 단위로 나누는 방식으로, 구현이 간단하고 빠르다는 장점이 있다. 
하지만 문장이나 단락의 의미적 구조를 고려하지 않기 때문에, 중요한 정보가 분할되어 검색 시 누락되거나 문맥이 왜곡될 수 있다는 단점이 있다. 또한 고정된 길이로 분할하기 때문에 문서의 내용과 구조에 따른 최적화가 어려울 수 있다.

## 부모-자식 분할

재귀적 문자 텍스트 분할 방식은 문서의 구조를 고려하여 분할하지만, 의미를 고려하지 않고 기계적인 규칙에 따라 텍스트를 분할하기 때문에 연관된 내용이 분리되어 문맥이 끊길 수 있는 문제가 있다. 

또한 의미 기반 분할은 텍스트의 의미적 연관서