
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../..">
      
      
        <link rel="next" href="../../../z.%EC%9E%A1%EB%8F%99%EC%82%AC%EB%8B%88/admonition/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Opensearch - SON BLOG</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=KyoboHand:300,300i,400,400i,700,700i%7CComic+Shanns:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"KyoboHand";--md-code-font:"Comic Shanns"}</style>
      
    
    
      <link rel="stylesheet" href="../../../extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#0" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="SON BLOG" class="md-header__button md-logo" aria-label="SON BLOG" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SON BLOG
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Opensearch
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  내 소개

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  A.포트폴리오

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../z.%EC%9E%A1%EB%8F%99%EC%82%AC%EB%8B%88/admonition/" class="md-tabs__link">
          
  
  Z.잡동사니

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SON BLOG" class="md-nav__button md-logo" aria-label="SON BLOG" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SON BLOG
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    내 소개
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    A.포트폴리오
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            A.포트폴리오
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    검색엔진
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            검색엔진
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Opensearch
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Opensearch
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0" class="md-nav__link">
    <span class="md-ellipsis">
      0. 기술 개요
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 갭션 추출
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 필요한 정보만 추출
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 검색엔진 랭킹 모델 구현
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#31-opensearch" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 OpenSearch 설정
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 임베딩 벡터 생성 및 저장
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 랭킹 모델 적용
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 검색 결과 제공
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Z.잡동사니
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Z.잡동사니
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../z.%EC%9E%A1%EB%8F%99%EC%82%AC%EB%8B%88/admonition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Admonition
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0" class="md-nav__link">
    <span class="md-ellipsis">
      0. 기술 개요
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 갭션 추출
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 필요한 정보만 추출
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 검색엔진 랭킹 모델 구현
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#31-opensearch" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 OpenSearch 설정
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 임베딩 벡터 생성 및 저장
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 랭킹 모델 적용
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 검색 결과 제공
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Opensearch</h1>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>💡 이 기술의 핵심은 텍스트로 이미지를 검색할 수 있다는 것</p>
</div>
<p>전통적인 이미지 검색은 메타데이터나 파일 이름을 기반으로 하지만,</p>
<p>시맨틱 검색은 이미지 자체의 내용을 이해하고 이를 바탕으로 유사한 이미지를 검색할 수 있는 기능을 말합니다.</p>
<p>일반적으로 이렇게 검색해서 결과를 받으려면, 단순 상품명 뿐만 아니라 상품에 대한 추가 정보를 입력해주어야 할 것이다.</p>
<p><code>겨울, 검정색, 데이트룩 등등</code></p>
<p><strong>하지만 이 기능의 핵심은 어떠한 추가 정보를 입력하지 않고도 딱 이미지 하나만을 가지고 텍스트를 검색할 수 있다는 것입니다.</strong></p>
<p>이미지에 대한 정보(캡션)을 추출할 수 있는 모델을 사용하여 데이터를 확보합니다.</p>
<p><strong>예시 시맨틱 검색어</strong></p>
<ul>
<li>밝은 빨간색 미니 원피스</li>
<li>어두운 파란색 롱 원피스</li>
<li>소매가 없는 노란색 원피스</li>
<li>흰색 로우탑 운동화</li>
<li>갈색 하이탑 운동화</li>
<li>
<p>여름에 입기 좋은 통기성 좋은 흰색 티셔츠</p>
</li>
<li>
<p>격식 있는 회색 슬랙스 바지</p>
</li>
<li>발 편한 여성용 운동화</li>
<li>방수 기능이 있느 겨울 부츠</li>
<li>골드 컬러의 미니멀한 디자인 귀걸이</li>
<li>데일리 룩에 어울리는 실버 팔찌</li>
</ul>
<h3 id="0">0. 기술 개요</h3>
<hr />
<ol>
<li>캡션 추출</li>
<li>캡션 임베딩 &amp; 검색어 임베딩</li>
<li>관련 상품 제공</li>
</ol>
<h3 id="1">1. 갭션 추출</h3>
<hr />
<p>먼저, 상품을 등록할 때 넣는 상품 이미지로부터 자동으로 갭션을 생성</p>
<p>이는 상품의 주요 내용을 자연어로 표현한 것</p>
<p>예를 들어, 신발사진에서 “빨간 줄무늬가 있는 런닝화 한 켤레” 와 같은 캡션을 생성</p>
<div class="admonition info">
<p class="admonition-title">영어 캡션</p>
<p>The image shows a young man standing in front of a building with a sign that reads "Royles". He is wearing a beige button-down shirt and black trousers. He is holding a black jacket in his left hand and has a pair of glasses on his right wrist. He has short black hair and is looking off to the side with a serious expression on his face. The building behind him has a wooden facade and large windows.</p>
</div>
<div class="admonition info">
<p class="admonition-title">한국어 캡션</p>
<p>그 이미지는 "Royles"라고 쓰여진 표지판이 있는 건물 앞에 서 있는 젊은 남자를 보여줍니다. 그는 베이지색 버튼다운 셔츠와 검은색 바지를 입고 있습니다. 그는 왼손에 검은색 재킷을 들고 있고 오른쪽 손목에 안경을 쓰고 있습니다. 그는 짧은 검은 머리를 가지고 있고 심각한 표정으로 옆을 내려다보고 있습니다. 그의 뒤에 있는 건물은 나무로 된 정면과 큰 창문을 가지고 있습니다.</p>
</div>
<h3 id="2">2. 필요한 정보만 추출</h3>
<hr />
<p>위에서 보신 캡션 데이터를 모두 쇼핑몰 데이터로 활용될 경우, 불필요한 데이터가 포함되어 검색 성능을 저하시킬 수 있습니다. 이를 방지하기 위해, 도메인에 맞춘 핵심 키워드만을 추출하고 중요도 순으로 데이터를 저장하는 방식을 채택하였습니다.</p>
<p>이러한 방식은 검색 정확도를 높이고 시스템 성능을 최적화하는 데 도움이 됩니다.</p>
<p>이미지 질의 모델을 통해 필요한 정보만을 추출하는 방법을 사용합니다.</p>
<ol>
<li><strong>카테고리</strong>: 상품의 종류 (예: 원피스, 운동화, 슬랙스 등)</li>
<li><strong>색상</strong>: 상품의 주요 색상 (예: 빨간색, 파란색, 노란색 등)</li>
<li><strong>성별</strong>: 상품의 대상 성별 (예: 여성용, 남성용)</li>
<li><strong>계절</strong>: 상품이 적합한 계절 (예: 여름옷, 겨울옷 등)</li>
</ol>
<p>이러한 정보를 자동으로 추출할 수 있도록 AI 모델을 설정하면, 모델은 이미지 안의 상품 정보를 정확하게 반환할 수 있습니다.</p>
<p>추출된 정보를 저장하기 위해 검색엔진 필드를 구성하고, 임베딩 벡터를 생성하여 저장합니다. 이러한 방식으로, 검색 쿼리에 대한 응답 시 임베딩 벡터를 활용하여 높은 정확도의 시맨틱 검색 결과를 제공합니다.</p>
<h3 id="3">3. 검색엔진 랭킹 모델 구현</h3>
<hr />
<p><strong>OpenSearch를 활용한 검색엔진 랭킹 모델 구현</strong></p>
<p>이미지에서 추출한 정보를 효과적으로 검색하기 위해 OpenSearch를 활용한 시맨틱 검색 기능을 구현합니다. 시맨틱 검색은 단순한 키워드 매칭을 넘어, 검색어와 문서 간의 의미적 유사성을 기반으로 결과를 제공하는 방식입니다. 이를 위해 랭킹 모델을 사용하여 검색 결과의 정확성을 높입니다.</p>
<h3 id="31-opensearch">3.1 OpenSearch 설정</h3>
<p>먼저, OpenSearch 클러스터를 구성합니다.</p>
<ol>
<li><strong>OpenSearch 클러스터 구성</strong>: 클러스터를 설정하고 필요한 인덱스를 생성합니다.</li>
<li><strong>인덱스 매핑 설정</strong>: 추출된 캡션 정보를 저장할 인덱스의 매핑을 설정합니다. 예를 들어, 'category', 'color', 'gender', 'season' 등의 필드를 포함합니다.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="err">PUT</span><span class="w"> </span><span class="err">/</span><span class="kc">fas</span><span class="err">hio</span><span class="kc">n</span><span class="err">_i</span><span class="kc">te</span><span class="err">ms</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;mappings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;goodsNm&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dense_vector&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;dims&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">768</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dense_vector&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;dims&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">768</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;gender&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dense_vector&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;dims&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">768</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;season&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dense_vector&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;dims&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">768</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;embedding&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dense_vector&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;dims&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">768</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="32">3.2 임베딩 벡터 생성 및 저장</h3>
<p>이미지 캡션을 통해 추출된 정보를 임베딩 벡터로 변환합니다. 이를 위해 사전 훈련된 모델(BERT, CLIP 등)을 사용하여 캡션을 벡터로 변환합니다. 예를 들어, CLIP 모델을 사용하여 이미지와 텍스트 모두에서 임베딩을 생성할 수 있습니다.</p>
<h3 id="33">3.3 랭킹 모델 적용</h3>
<p>검색 요청을 처리하기 위해 사용자의 쿼리를 임베딩 벡터로 변환한 후, OpenSearch의 k-NN 검색 기능을 사용하여 유사한 항목을 찾습니다. 랭킹 모델을 통해 검색 결과의 순위를 정하여, 가장 관련성이 높은 결과를 상위에 노출시킵니다.</p>
<ol>
<li><strong>사용자 쿼리 임베딩</strong>: 사용자의 텍스트 쿼리를 임베딩 벡터로 변환합니다.</li>
<li><strong>k-NN 검색 수행</strong>: OpenSearch의 k-NN 검색을 통해 유사한 항목을 검색합니다.</li>
<li><strong>랭킹 모델 적용</strong>: 검색 결과에 랭킹 모델을 적용하여 순위를 매깁니다.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;밝은 빨간색 미니 원피스&quot;</span>
<span class="n">query_embedding</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_text_features</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">search_query</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;bool&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;should&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;knn&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="n">query_embedding</span><span class="p">,</span>
              <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="mi">10</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;knn&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="n">query_embedding</span><span class="p">,</span>
              <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="mi">10</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;knn&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="n">query_embedding</span><span class="p">,</span>
              <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="mi">10</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;knn&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="n">query_embedding</span><span class="p">,</span>
              <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="mi">10</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;knn&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;embedding&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="n">query_embedding</span><span class="p">,</span>
              <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="mi">10</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;rescore&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;query_weight&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="s2">&quot;rescore_query_weight&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>
    <span class="s2">&quot;rescore_query&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;rank_feature&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;popularity&quot;</span><span class="p">,</span>
        <span class="s2">&quot;factor&quot;</span><span class="p">:</span> <span class="mf">1.2</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">opensearch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;fashion_items&quot;</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">search_query</span><span class="p">)</span>
</code></pre></div>
<h3 id="34">3.4 검색 결과 제공</h3>
<p>검색 결과는 사용자에게 가장 관련성이 높은 항목부터 순서대로 제공됩니다. OpenSearch의 랭킹 모델을 통해 유사성을 기준으로 결과를 정렬하여 제공합니다.</p>
<p>이와 같은 방식으로 OpenSearch와 임베딩 벡터를 활용한 시맨틱 검색을 구현하면, 사용자에게 더욱 정확하고 유의미한 검색 결과를 제공할 수 있습니다. 이를 통해 사용자 경험을 크게 향상시킬 수 있으며, 쇼핑몰에서 원하는 상품을 빠르고 정확하게 찾을 수 있게 됩니다.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: 내 소개">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                내 소개
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../z.%EC%9E%A1%EB%8F%99%EC%82%AC%EB%8B%88/admonition/" class="md-footer__link md-footer__link--next" aria-label="Next: Admonition">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Admonition
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.instant.prefetch", "palette-toggle", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "search.highlight", "navigation.footer"], "search": "../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>