## 의미 기반으로 분할하는 시맨틱 청킹

`SemanticChunker` 는 텍스트를 단순히 길이에 따라 나누는 것이 아닌, 의미적으로 유사한 내용을 가진 청크로 분할하는 도구이다. 텍스트를 문장 단위로 분할한 후, 서로 유사한 의미를 가진 문장들을 그룹화하여 하나의 청크로 구성한다. 이를 통해 문맥이 잘 연결된 상태로 분할되어, 텍스트의 의미를 보존하면서도 적절한 크기의 청크를 생성할 수 있다.

의미 분할 방식은 청크가 문맥적으로 일관성을 갖도록 하여 이후의 자연어 처리나 정보 검색에서 더욱 정확한 결과를 얻을 수 있다. 특히, RAG와 같은 작업에서 문맥이 잘 연결된 청크들이 입력되면, 모델의 응답 정화도가 크게 향상될 수 있다.

```python
from langChain_experimental.text_splitter import SemanticChunker
```

SemanticChunker 의 기본 파라미터는 `breakpoint_threshold_type='percentile'` 과 `breakpoint_threshold_amount=95` 로 설정되어 있다. 이는 의미적 차이의 분포에서 95번째 백분위수를 초과하는 지점, 즉 상위 5%에 해당하는 큰 차이가 발생하는 지점을 분할 기준으로 선택한다. 이를 통해 의미적으로 큰 전환이 일어나는 곳에서 자연스럽게 텍스트를 나눌 수 있다.


# python rag/chunker.py
2025-07-20 15:57:08,817 [INFO] OPENAI_API_KEY 로드 성공
2025-07-20 15:57:08,817 [INFO] 문서 로드 시도: /Users/sonseongjun/IdeaProjects/plateer/loca-scraping/rag/data/26. 플래티어 가이드북_2025_최신_250610.docx
2025-07-20 15:57:08,913 [INFO] 문서에서 텍스트 추출 완료 (총 14764자)
2025-07-20 15:57:08,913 [INFO] 청킹 완료: 총 37개의 청크 생성
2025-07-20 15:57:08,913 [INFO] OpenAI 임베딩 초기화
2025-07-20 15:57:09,034 [INFO] FAISS 인덱스 생성 시작
2025-07-20 15:57:09,892 [INFO] HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-07-20 15:57:10,526 [INFO] Loading faiss.
2025-07-20 15:57:10,548 [INFO] Successfully loaded faiss.
2025-07-20 15:57:10,551 [INFO] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
2025-07-20 15:57:10,553 [INFO] FAISS 인덱스 생성 완료
2025-07-20 15:57:10,553 [INFO] 검색 실행: 쿼리 = '동호회 지원 제도에서 관리부서와 문의처가 누군지 알려줘'
2025-07-20 15:57:10,795 [INFO] HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-07-20 15:57:10,801 [INFO] 검색 완료: 2개 결과 반환

=== 검색 결과 상위 2개 ===
1. '동호회 조직 구성: 회장 1명, 부회장 1명, 총무 1명 기타 각 동호회는 월 1회 이상 활동함을 원칙으로 한다. 등록 회원이 3회 이상 불참 시 회원 자격을 박탈한다. 비 등록 회원에 대해 당해 활동 시 개인부담을 차등 적용한다. 매월 개인비용 신청 시 참여인원을 모두 기재한 증빙서류를 첨부하여 당사 결재 양식에 의거 신청하여야 한다. 오프라인 모임 참여 시, 최소 4인 이상인 경우에만 활동 인정 점심시간 및 근무시간 內 동호회 활동 금지 동호회 활동 이후 활동일지에 사진 게시 필수 [회사 혹은 집결지 사진은 미인정] ▶ 문의처 : 경영지원실 이형대 프로 단체상해보험 지원대상: 전 임직원 보장내용 [실손보험 및 각종 정액담보 보장-정액담보는 개인보험과 중복 보장 가능] ▶ 문의처 : 경영지원실 이형대 프로  출장 규정 해외 출장여비 일 지급기준(달러 기준) 출장여비 지급 규정'...

2025-07-20 15:57:10,802 [INFO] 결과 1: 동호회 조직 구성: 회장 1명, 부회장 1명, 총무 1명 기타 각 동호회는 월 1회 이상 활동함을 원칙으로 한다. 등록 회원이 3회 이상 불참 시 회원 자격을 박탈한다. 비 등록 ...
2. '▶ 문의처 : HR실 함승화 프로 08 사우회 운영목적: 회원 상호간의 친목도모, 복지향상과 상부상조 직급 별 사우회비(월 기준) 경조사 발생 시 경조금 지급규정 신청방법 경조사 발생 시, 직접 신청서 작성 신청서류: 그룹웨어 – 전자결재 – [사우회 지원금 신청서] 결재라인: (결재) 사우회 총무 [이치훈 프로] – (결재) 사우회장 [박승준 파트리더] ▶ 문의처 : EC운영사업2실 EC개발2팀 박승준 파트리더 09 기타 안내사항 행사안내 전사 워크샵: 매년 9~10월 중 진행, 전 임직원 필수 참석 송년회: 매년 12월 말 진행, 전 임직원 필수 참석 호프데이: 분기 1회 진행, 전 임직원 선택 참석 (행사일자 경영지원실 공지) ▶ 문의처 : 경영지원실 이형대 프로 본사 회의실 및 거점 오피스 안내 본사 회의실 거점 오피스 명칭: Stage당산 주소: 서울시 영등포구 당산로 41길 11 E동 1112호 (당산로4가, sk v1 center)'...

2025-07-20 15:57:10,802 [INFO] 결과 2: ▶ 문의처 : HR실 함승화 프로 08 사우회 운영목적: 회원 상호간의 친목도모, 복지향상과 상부상조 직급 별 사우회비(월 기준) 경조사 발생 시 경조금 지급규정 신청방법 경조사 ...
(scrap) ~/IdeaProjects/plateer/loca-scraping


025-07-20 16:05:37,094 [INFO] 문서에서 텍스트 추출 완료 (총 14764자)
2025-07-20 16:05:37,094 [INFO] OpenAI 임베딩 초기화
2025-07-20 16:05:37,246 [INFO] SemanticChunker 초기화 및 청킹 시작
2025-07-20 16:05:38,299 [INFO] HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-07-20 16:05:38,735 [INFO] Semantic 청킹 완료: 총 7개의 청크 생성
2025-07-20 16:05:38,735 [INFO] FAISS 인덱스 생성 시작
2025-07-20 16:05:39,898 [INFO] HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-07-20 16:05:40,520 [INFO] Loading faiss.
2025-07-20 16:05:40,560 [INFO] Successfully loaded faiss.
2025-07-20 16:05:40,563 [INFO] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
2025-07-20 16:05:40,564 [INFO] FAISS 인덱스 생성 완료
2025-07-20 16:05:40,564 [INFO] 검색 실행: 쿼리 = '동호회 지원 제도에서 관리부서와 문의처가 누군지 알려줘'
2025-07-20 16:05:40,923 [INFO] HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-07-20 16:05:40,931 [INFO] 검색 완료: 2개 결과 반환

=== 검색 결과 상위 2개 ===
1. '동호회의 행사계획이 회사업무에 큰 지장을 초래한다고 판단될 때 행사를 중단 또는 연기할 수 있다. 동호회 등록 등록신청서/회원명부/조직도를 경영지원실에 제출하여야 한다. 동호회 등록은 매년 1월 재정비하여 각 동호회에서 등록신청서/명부를 제출한다. 동호회 회원자격은 회사에 재직중인 임직원으로 한다. 회원 수는 최소 7명 이상 일 때 등록이 가능하다. 동호회 활동은 사내 활동이기 때문에 그룹웨어 커뮤니티에 활동보고를 올리는 것으로 한다. 동호회는 최대 2개까지 가입 가능하며, 2개의 동호회에 대해서 지원금을 지원한다. 동호회 이동은 년 2회로 정한다. 동호회 취소 회원구성이 등록요건에 미달될 경우 활동내역이 그 설립목적에 위반되는 경우 특별한 사유 없이 3개월이상 활동이 없는 경우 동호회 가입 및 탈퇴 동호회 가입을 희망하는 자는 가입신청서를 작성, 해당 동호회에 신청하여야 한다. 가입한 동호회를 탈퇴를 희망하는 자는 탈퇴신청서를 작성, 해당 동호회에 제출 및 신청하여야 한다. 동호회 조직 구성: 회장 1명, 부회장 1명, 총무 1명 기타 각 동호회는 월 1회 이상 활동함을 원칙으로 한다. 등록 회원이 3회 이상 불참 시 회원 자격을 박탈한다.'...

2025-07-20 16:05:40,931 [INFO] 결과 1: 동호회의 행사계획이 회사업무에 큰 지장을 초래한다고 판단될 때 행사를 중단 또는 연기할 수 있다. 동호회 등록 등록신청서/회원명부/조직도를 경영지원실에 제출하여야 한다. 동호회 등록은 매년 1월 재정비하여 각 동호회에서 등록신청서/명부를 제출한다. 동호회 회원자격은 회사에 재직중인 임직원으로 한다. 회원 수는 최소 7명 이상 일 때 등록이 가능하다. 동호회 활동은 사내 활동이기 때문에 그룹웨어 커뮤니티에 활동보고를 올리는 것으로 한다. 동호회는 최대 2개까지 가입 가능하며, 2개의 동호회에 대해서 지원금을 지원한다. 동호회 이동은 년 2회로 정한다. 동호회 취소 회원구성이 등록요건에 미달될 경우 활동내역이 그 설립목적에 위반되는 경우 특별한 사유 없이 3개월이상 활동이 없는 경우 동호회 가입 및 탈퇴 동호회 가입을 희망하는 자는 가입신청서를 작성, 해당 동호회에 신청하여야 한다. 가입한 동호회를 탈퇴를 희망하는 자는 탈퇴신청서를 작성, 해당 동호회에 제출 및 신청하여야 한다. 동호회 조직 구성: 회장 1명, 부회장 1명, 총무 1명 기타 각 동호회는 월 1회 이상 활동함을 원칙으로 한다. 등록 회원이 3회 이상 불참 시 회원 자격을 박탈한다....
2. '비 등록 회원에 대해 당해 활동 시 개인부담을 차등 적용한다. 매월 개인비용 신청 시 참여인원을 모두 기재한 증빙서류를 첨부하여 당사 결재 양식에 의거 신청하여야 한다. 오프라인 모임 참여 시, 최소 4인 이상인 경우에만 활동 인정 점심시간 및 근무시간 內 동호회 활동 금지 동호회 활동 이후 활동일지에 사진 게시 필수 [회사 혹은 집결지 사진은 미인정] ▶ 문의처 : 경영지원실 이형대 프로 단체상해보험 지원대상: 전 임직원 보장내용 [실손보험 및 각종 정액담보 보장-정액담보는 개인보험과 중복 보장 가능] ▶ 문의처 : 경영지원실 이형대 프로  출장 규정 해외 출장여비 일 지급기준(달러 기준) 출장여비 지급 규정 숙박 비용은 각 직급별 한도로 하여 실비 정산을 원칙으로 하며, 현지조건에 따라 한도 여부에 관계없이 실비 정산될 수 있으며, 직원이 상급자와 동반 출장 시에는 숙박비용은 상급자 직급에 해당하는 숙박비를 지급할 수 있다 식대, 교통비, 일비는 비용 정산 없이 지급한다. 식대 및 교통비 부족금액은 일비에서 충당한다.'...

2025-07-20 16:05:40,932 [INFO] 결과 2: 비 등록 회원에 대해 당해 활동 시 개인부담을 차등 적용한다. 매월 개인비용 신청 시 참여인원을 모두 기재한 증빙서류를 첨부하여 당사 결재 양식에 의거 신청하여야 한다. 오프라인 모임 참여 시, 최소 4인 이상인 경우에만 활동 인정 점심시간 및 근무시간 內 동호회 활동 금지 동호회 활동 이후 활동일지에 사진 게시 필수 [회사 혹은 집결지 사진은 미인정] ▶ 문의처 : 경영지원실 이형대 프로 단체상해보험 지원대상: 전 임직원 보장내용 [실손보험 및 각종 정액담보 보장-정액담보는 개인보험과 중복 보장 가능] ▶ 문의처 : 경영지원실 이형대 프로  출장 규정 해외 출장여비 일 지급기준(달러 기준) 출장여비 지급 규정 숙박 비용은 각 직급별 한도로 하여 실비 정산을 원칙으로 하며, 현지조건에 따라 한도 여부에 관계없이 실비 정산될 수 있으며, 직원이 상급자와 동반 출장 시에는 숙박비용은 상급자 직급에 해당하는 숙박비를 지급할 수 있다 식대, 교통비, 일비는 비용 정산 없이 지급한다. 식대 및 교통비 부족금액은 일비에서 충당한다....
(scrap) ~/IdeaProjects/plateer/loca-scraping
# 