챗봇을 개발할 때 대화의 흐름을 유지하는 기능은 사용자 경험을 크게 향상시킬 수 있다.
대화 이력을 관리하면 사용자가 이전에 어떤 질문을 했는지 기억하고, 연관된 답변을 제공할 수 있다.
이렇게하면 보다 자연스럽고 맥락을 반영한 대화를 이어갈 수 있다.

## 기본적인 대화 이력 전달

챗봇에 메모리를 추가하는 가장 간단한 방법은 이전 대화를 그대로 프롬프트를 전달하는 것이다.
```python
ai_msg = chain.invoke(
	{
		"messages": [
			("human", "저축을 늘리기 위해 무엇을 할 수 있나요?"), # 사용자의 첫 질문
			("ai", "")
		]
	}
)
```

## 대화 이력 관리 및 처리

`ChatMessageHistory` 클래스를 사용하면 대화 내용을 저장하고 재사용하는 등, 대화 이력을 더 체계적으로 관리 할 수 있다.

## 대화 이력 요약 및 트리밍

챗봇이 긴 대화를 처리할 때, 이전 메시지를 모두 기억하는 것은 비효율적일 수 있다. 시간이 지날수록 대화 이력이 길어져 모델이 처리해야 할 정보량이 증가하면서 응답 속도가 느려지고 불필요한 리소스가 사용될 수 있다.
이를 개선하기 위해 오래된 메시지를 요약하거나 삭제하여 모델이 처리할 메시지 수를 줄일 수 있다.

### 메시지 트리밍
Message Trimming 이란 AI 모델이 대화를 처리할 때, 처리해야 할 정보의 양을 줄여 더 빠르게 효율적으로 응답할 수 있도록 하는 방법이다. 트리밍은 일반적으로 긴 대화 기록 중에서 가장 최근의 몇 개 메시지만 남기고 오래된 메시지는 삭제하는 방식으로 이뤄진다.

### 대화 요약 활용
대화가 길어지면 모든 대화 기록을 기억하는 것은 비효율적일 수 있다. 메모리 사용량이 커지고, 모델이 불필요한 정보까지 참조하여 처리 시간이 증가할 수 있기 때문이다. 이때 대화 요약을 사용하면, 이전 대화를 압축하여 중요한 정보만 남기고 AI가 새로운 질문에 대해 응답할 때 요약된 대화만 참조하도록 할 수 있다. 이렇게 하면 AI 모델은 더 적은 데이터를 기반으로도 대화 맥박을 유지하면서 효율적으로 응답할 수 있다.

다음은 이전에 질문하고 답변했던 대화를 요약한 후, 새로운 질문에 대한 응답을 생성하는 예제
1. 이전 대화 이력
2. 요약 후 이전 대화 삭제
3. 요약된 메시지를 대화 이력에 추가


